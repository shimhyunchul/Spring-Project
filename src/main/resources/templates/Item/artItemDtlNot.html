<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">

<head>
  <link th:href="@{/css/artItemDtlNot.css}" rel="stylesheet">
  <meta name="_csrf" th:content="${_csrf.token}"/>
  <meta name="_csrf_header" th:content="${_csrf.headerName}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<th:block layout:fragment="script">
  <script th:inline="javascript">

function redirectToLogin() {
// 로그인하지 않았을 경우 알림 메시지
alert("로그인 후 사용하세요.");

// 로그인 페이지로 리디렉션
window.location.href = '/members/login';  // 로그인 페이지 URL
}
  </script>
</th:block>



<body>
<div layout:fragment="content" style="margin-left:25%;margin-right:25%">

  <input type="hidden" id="itemId" th:value="${item.id}">

  <div class="d-flex">
    <div class="left-section">

      <!-- item.imgUrl이 null이 아니면 해당 이미지를 사용 -->
      <img th:if="${not #strings.isEmpty(item.imgUrl)}"
           th:src="${item.imgUrl}"
           class="rounded repImg"
           th:alt="${item.artName}">

      <!-- item.imgUrl이 null이거나 비어 있으면 itemImgs의 첫 번째 이미지를 사용 -->
      <img th:unless="${not #strings.isEmpty(item.imgUrl)}"
           th:src="${itemImgs[0]?.imgUrl}"
           class="rounded mgb-15">

    </div>



    <div class="right-section">


      <span th:if="${item.itemSellStatus == T(com.shop.constant.ItemSellStatus).SELL
            and (item.eventEnd != null and item.eventEnd.isAfter(T(java.time.LocalDateTime).now()))
            and (item.eventStart != null and item.eventStart.isBefore(T(java.time.LocalDateTime).now()))}"
            class="badge bg-primary mgb-15">경매 진행중</span>

      <span th:unless="${item.itemSellStatus == T(com.shop.constant.ItemSellStatus).SELL}"
            class="badge bg-primary mgb-15">경매 완료</span>

      <span th:unless="${item.itemSellStatus == T(com.shop.constant.ItemSellStatus).SOLD_OUT
            or (item.eventEnd != null and item.eventEnd.isAfter(T(java.time.LocalDateTime).now()))
            and (item.eventStart != null and item.eventStart.isBefore(T(java.time.LocalDateTime).now()))}"
            class="badge bg-primary mgb-15">경매시간이 아닙니다</span>


      <div class="h4" th:text="${item.artName}"></div>


      <div class="text-right mgt-50">
        <p style="color: red">로그인시 그래프가 나옵니다.</p>


        <hr class="my-4">

        <div class="price">
          <h6>작가명</h6>
          <h3 name="artistName" id="artistName" class="font-weight-bold"></h3>
          <p class="name" th:text="${item.artistName}"></p>
        </div>

        <div class="price">
          <h6>추정가</h6>
          <h3 name="priceRange" id="priceRange" class="font-weight-bold"></h3>
          <p class="range" th:text="${item.priceRange}">원</p>
        </div>

        <div class="price">
          <h6>시작가</h6>
          <h3 name="startPrice" id="startPrice" class="font-weight-bold"></h3>
          <p class="start" th:text="${item.startPrice}">원</p>
        </div>
      </div>




      <!-- SELL 상태인 경우 -->
      <div th:if="${item.itemSellStatus == T(com.shop.constant.ItemSellStatus).SELL}">
        <button id="gotoLogin" type="button" class="btn btn-primary btn-lg px-4" onclick="redirectToLogin()">
          경매 응찰하기
        </button>
      </div>

      <div th:unless="${item.itemSellStatus == T(com.shop.constant.ItemSellStatus).SELL}">
        <button type="button" class="btn btn-primary btn-lg px-4">품절</button>
      </div>
    </div>
  </div>

  <div class="mgt-30">
    <div >
      <hr>
      <h4 class="writer" >상품 상세 설명</h4>
    </div>
  </div>


  <div class="writerDesc">
    <div >
      <h5><strong>작품 설명</strong></h5>
      <div class="lead" th:text="${item.writerDesc}" style="white-space: pre-wrap;"></div>
      <br>
    </div>
  </div>



  <div>
    <img th:if="${not #strings.isEmpty(item.imgUrl)}" th:src="${item.imgUrl}"
         class="rounded mgb-15"
         width="600">
  </div>


  <div>
    <div th:each="ItemImg : ${itemImgs}" class="text-center">
      <img th:if="${not #strings.isEmpty(ItemImg.imgUrl)}" th:src="${ItemImg.imgUrl}"
           class="rounded mgb-15"
           width="800">
    </div>
  </div>


</div>
<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
</div>

</body>
</html>
